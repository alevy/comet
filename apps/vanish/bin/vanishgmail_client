#!/usr/bin/env bash
USAGE="USAGE: $0 <sds root directory> <sds-options> ..."

if [ $# -lt 1 ]
then
  echo $USAGE
  exit 1
fi

sds_root=$1; shift

bin="$sds_root/bin"
bin=`cd "$bin"; pwd`

. "$bin"/vanish-config.sh

errCode=$?
if [ $errCode -ne 0 ]
then
  echo "Error initializing."
  exit $errCode
fi

#export JAVA_HOME

#runner_class="edu.washington.cs.vanish.apps.VanishClientRunner"
runner_class="edu.washington.cs.vanish.apps.ActiveDHTVanishClientImpl"
sds_class="edu.washington.cs.vanish.apps.vanishgmail.PluginClient"

# Runs the Vanish client.

echo "$bin/vanish $runner_class -c $sds_class $@"
"$bin"/vanish $runner_class -c $sds_class $@
errCode=$?
if [ $errCode -eq 0 ]
then
  echo "SDS operation succeeded."  # Very important for plugins.
  exit 0
else
  echo "SDS operation failed."
  exit -1
fi

